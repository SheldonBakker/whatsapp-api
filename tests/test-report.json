{
  "timestamp": "2025-06-08T02:09:39.343Z",
  "results": {
    "swagger": {
      "success": true,
      "total": 0,
      "passed": 0,
      "failed": 0,
      "skipped": 0,
      "duration": 0,
      "output": "\n> whatsapp-web-api@1.0.0 test:swagger\n> cross-env PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true DISABLE_WEB_SECURITY=true jest tests/swagger-validation.test.js --detectOpenHandles --forceExit\n\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: Attempting to restore sessions from disk...\n  console.log\n    ✓ Session path found: /session/start/{sessionId}\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Session path found: /session/status/{sessionId}\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Session path found: /session/qr/{sessionId}\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Session path found: /session/qr/{sessionId}/image\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Session path found: /session/restart/{sessionId}\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Session path found: /session/terminate/{sessionId}\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Session path found: /session/terminateInactive\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Session path found: /session/terminateAll\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Session path found: /session/all\n\n      at log (tests/swagger-validation.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Client path found: /client/getClassInfo/{sessionId}\n\n      at log (tests/swagger-validation.test.js:75:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Client path found: /client/getNumberId/{sessionId}\n\n      at log (tests/swagger-validation.test.js:75:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Client path found: /client/getState/{sessionId}\n\n      at log (tests/swagger-validation.test.js:75:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Client path found: /client/sendMessage/{sessionId}\n\n      at log (tests/swagger-validation.test.js:75:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Client path found: /client/getWWebVersion/{sessionId}\n\n      at log (tests/swagger-validation.test.js:75:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /message/delete/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /chat/getClassInfo/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /chat/delete/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /chat/clearMessages/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /chat/clearState/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /chat/fetchMessages/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /chat/getContact/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /chat/sendStateRecording/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /chat/sendStateTyping/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /contact/getClassInfo/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /contact/block/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /contact/getAbout/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /contact/getChat/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /contact/unblock/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /contact/getFormattedNumber/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /contact/getCountryCode/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Path found: /contact/getProfilePicUrl/{sessionId}\n\n      at log (tests/swagger-validation.test.js:102:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Request body defined for: /client/getNumberId/{sessionId}\n\n      at log (tests/swagger-validation.test.js:144:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Request body defined for: /client/sendMessage/{sessionId}\n\n      at log (tests/swagger-validation.test.js:144:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Request body defined for: /message/delete/{sessionId}\n\n      at log (tests/swagger-validation.test.js:144:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: StartSessionResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: StatusSessionResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: RestartSessionResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: TerminateSessionResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: TerminateSessionsResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: SendMessageRequest\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: ChatIdRequest\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: ContactIdRequest\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: ErrorResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: NotFoundResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: ForbiddenResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: BadRequestResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Schema defined: UnprocessableEntityResponse\n\n      at log (tests/swagger-validation.test.js:169:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Response defined: ErrorResponse\n\n      at log (tests/swagger-validation.test.js:184:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Response defined: NotFoundResponse\n\n      at log (tests/swagger-validation.test.js:184:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Response defined: ForbiddenResponse\n\n      at log (tests/swagger-validation.test.js:184:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Response defined: BadRequestResponse\n\n      at log (tests/swagger-validation.test.js:184:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    ✓ Response defined: UnprocessableEntityResponse\n\n      at log (tests/swagger-validation.test.js:184:17)\n          at Array.forEach (<anonymous>)\n\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: Reading session directory: ./sessions\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: Found items in session directory: 1\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [ReqID: 6uk8uoz1k6m] GET /ping [STARTED]\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [ReqID: 6uk8uoz1k6m] GET /ping [FINISHED] 200 3ms\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [Session: invalid session] Existing session directory found, initiating restore\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [Session: invalid session] Initiating session setup\n2025-06-08 04:09:05 \u001b[31merror\u001b[39m: [Session: invalid session] Failed to create Client instance: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: Session restore process initiated for 1 sessions.\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [ReqID: ov2cxezmvpm] GET /health [STARTED]\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [ReqID: ov2cxezmvpm] GET /health [FINISHED] 200 1ms\n  console.log\n    ✓ Health endpoints accessible\n\n      at Object.log (tests/swagger-validation.test.js:201:15)\n\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [ReqID: ixuxp5745j] GET /session/start/swagger-test-session [STARTED]\n  console.log\n    [Controller] Starting new session setup for: swagger-test-session\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Initiating session setup\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Created session directory: sessions/session-swagger-test-session\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Initializing event listeners\n2025-06-08 04:09:05 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: ixuxp5745j] GET /session/start/swagger-test-session [FINISHED] 202 9ms\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: j2ro7hudsd] GET /session/status/swagger-test-session [STARTED]\n2025-06-08 04:09:06 \u001b[33mwarn\u001b[39m: [Session: swagger-test-session] Browser validation check: Not connected or pupBrowser missing.\n2025-06-08 04:09:06 \u001b[31merror\u001b[39m: [Session: swagger-test-session] Browser validation check: getState() failed after browser unresponsive/missing: Cannot read properties of null (reading 'evaluate')\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: j2ro7hudsd] GET /session/status/swagger-test-session [FINISHED] 200 2ms\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: n5dmi2z43hr] GET /session/all [STARTED]\n  console.log\n    [Controller] Getting status for all 1 active sessions...\n\n      at log (src/controllers/sessionController.ts:424:13)\n\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: n5dmi2z43hr] GET /session/all [FINISHED] 200 1ms\n  console.log\n    ✓ Session endpoints accessible\n\n      at Object.log (tests/swagger-validation.test.js:223:17)\n\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: 4a708l4rajg] GET /session/terminate/swagger-test-session [STARTED]\n  console.log\n    [Controller] Termination requested for session: swagger-test-session\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Deletion requested\n2025-06-08 04:09:06 \u001b[33mwarn\u001b[39m: [Session: swagger-test-session] Browser validation check: Not connected or pupBrowser missing.\n2025-06-08 04:09:06 \u001b[31merror\u001b[39m: [Session: swagger-test-session] Browser validation check: getState() failed after browser unresponsive/missing: Cannot read properties of null (reading 'evaluate')\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Session removed from active map for deletion.\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Session state is ERROR. Attempting destroy...\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] No browser instance found on client. Skipping destroy, attempting kill.\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Ensuring browser process is terminated...\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Deleting session data folder...\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Attempting to delete session folder: sessions/session-swagger-test-session\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-swagger-test-session\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-swagger-test-session\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Session terminated and data cleaned successfully.\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: 4a708l4rajg] GET /session/terminate/swagger-test-session [FINISHED] 200 9ms\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: lepxesgt1j] GET /session/start/swagger-validation-session [STARTED]\n  console.log\n    [Controller] Starting new session setup for: swagger-validation-session\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Initiating session setup\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Created session directory: sessions/session-swagger-validation-session\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Initializing event listeners\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [ReqID: lepxesgt1j] GET /session/start/swagger-validation-session [FINISHED] 202 5ms\n2025-06-08 04:09:06 \u001b[31merror\u001b[39m: [Session: swagger-test-session] Initialization attempt 1/3 failed: Failed to launch the browser process!\n\n\nTROUBLESHOOTING: https://github.com/puppeteer/puppeteer/blob/main/docs/troubleshooting.md\n\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Retrying initialization in 10 seconds...\n2025-06-08 04:09:06 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Killed Chrome processes using profile: /usr/src/app/.wwebjs_auth/session-swagger-test-session/puppeteer_chrome_profile\n2025-06-08 04:09:07 \u001b[32minfo\u001b[39m: [ReqID: 02v2ouyatzkm] POST /client/getNumberId/swagger-validation-session [STARTED]\n2025-06-08 04:09:12 \u001b[33mwarn\u001b[39m: [Session: swagger-validation-session] Validation check: Page evaluation failed: page_evaluation_timeout\n2025-06-08 04:09:12 \u001b[33mwarn\u001b[39m: [ReqID: 02v2ouyatzkm] POST /client/getNumberId/swagger-validation-session [FINISHED] 404 5268ms\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [ReqID: a6wco3gxxgd] POST /client/sendMessage/swagger-validation-session [STARTED]\n2025-06-08 04:09:12 \u001b[33mwarn\u001b[39m: [Session: swagger-validation-session] Validation check: Session state is null\n2025-06-08 04:09:12 \u001b[33mwarn\u001b[39m: [ReqID: a6wco3gxxgd] POST /client/sendMessage/swagger-validation-session [FINISHED] 404 73ms\n  console.log\n    ✓ Request body validation working\n\n      at Object.log (tests/swagger-validation.test.js:258:17)\n\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [ReqID: jizzcgh68oi] GET /session/terminate/swagger-validation-session [STARTED]\n  console.log\n    [Controller] Termination requested for session: swagger-validation-session\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Deletion requested\n2025-06-08 04:09:12 \u001b[33mwarn\u001b[39m: [Session: swagger-validation-session] Validation check: Session state is null\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Session removed from active map for deletion.\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Session in uncertain state (session_not_connected). Attempting destroy...\n2025-06-08 04:09:12 \u001b[31merror\u001b[39m: [Session: swagger-validation-session] Initialization attempt 1/3 failed: Navigation failed because browser has disconnected!\n2025-06-08 04:09:12 \u001b[31merror\u001b[39m: [Session: swagger-validation-session] Potentially unrecoverable browser error detected. Cleaning up browser.\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Attempting graceful browser close\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Killed Chrome processes using profile: /usr/src/app/.wwebjs_auth/session-swagger-validation-session/puppeteer_chrome_profile\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Browser closed gracefully\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Client destroy successful.\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Ensuring browser process is terminated...\n2025-06-08 04:09:12 \u001b[31merror\u001b[39m: [Session: swagger-validation-session] Initialization failed due to unrecoverable browser error after 3 attempts.\n2025-06-08 04:09:12 \u001b[31merror\u001b[39m: [Session: swagger-validation-session] Handling fatal initialization failure.\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Session removed from active map due to initialization failure.\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Deleting session data folder...\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Attempting to delete session folder: sessions/session-swagger-validation-session\n  console.error\n    Failed to send webhook (swagger-validation-session, status):\n\n      82 |     (error?: Error): void => {\n      83 |       const errorMsg = error ? error.message : 'Circuit is open';\n    > 84 |       console.error(`Failed to send webhook (${sessionId}, ${dataType}): ${errorMsg}`);\n         |               ^\n      85 |     }\n      86 |   ).catch(() => {\n      87 |     // Ignore errors from webhook calls\n\n      at error (src/utils.ts:84:15)\n      at CircuitBreaker.fallback [as exec] (src/utils.ts:43:14)\n\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-swagger-validation-session\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-swagger-validation-session\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session] Session terminated and data cleaned successfully.\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [ReqID: jizzcgh68oi] GET /session/terminate/swagger-validation-session [FINISHED] 200 94ms\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [ReqID: w4wwn4k4tg] GET /session/start/swagger-validation-session-2 [STARTED]\n  console.log\n    [Controller] Starting new session setup for: swagger-validation-session-2\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Initiating session setup\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Created session directory: sessions/session-swagger-validation-session-2\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Initializing event listeners\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:12 \u001b[32minfo\u001b[39m: [ReqID: w4wwn4k4tg] GET /session/start/swagger-validation-session-2 [FINISHED] 202 4ms\n2025-06-08 04:09:13 \u001b[32minfo\u001b[39m: [ReqID: u80vidcmpm9] GET /session/status/invalid%20session%20id [STARTED]\n2025-06-08 04:09:13 \u001b[33mwarn\u001b[39m: [ReqID: u80vidcmpm9] GET /session/status/invalid%20session%20id [FINISHED] 404 3ms\n2025-06-08 04:09:13 \u001b[32minfo\u001b[39m: [ReqID: fb8i8c63vfk] POST /client/getNumberId/swagger-validation-session-2 [STARTED]\n2025-06-08 04:09:16 \u001b[32minfo\u001b[39m: [Session: swagger-test-session] Cleaning up browser before retry...\n2025-06-08 04:09:16 \u001b[33mwarn\u001b[39m: [Session: swagger-test-session] Initialization cancelled, client already destroyed.\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [Session: swagger-validation-session-2] Validation check: Page evaluation failed: page_evaluation_timeout\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [ReqID: fb8i8c63vfk] POST /client/getNumberId/swagger-validation-session-2 [FINISHED] 404 5236ms\n  console.log\n    ✓ Invalid request rejection working\n\n      at Object.log (tests/swagger-validation.test.js:286:17)\n\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [ReqID: 4nw0qa1k75s] GET /session/terminate/swagger-validation-session-2 [STARTED]\n  console.log\n    [Controller] Termination requested for session: swagger-validation-session-2\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Deletion requested\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [Session: swagger-validation-session-2] Validation check: Session state is null\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Session removed from active map for deletion.\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Session in uncertain state (session_not_connected). Attempting destroy...\n2025-06-08 04:09:18 \u001b[31merror\u001b[39m: [Session: swagger-validation-session-2] Initialization attempt 1/3 failed: Navigation failed because browser has disconnected!\n2025-06-08 04:09:18 \u001b[31merror\u001b[39m: [Session: swagger-validation-session-2] Potentially unrecoverable browser error detected. Cleaning up browser.\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Attempting graceful browser close\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Killed Chrome processes using profile: /usr/src/app/.wwebjs_auth/session-swagger-validation-session-2/puppeteer_chrome_profile\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Browser closed gracefully\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Client destroy successful.\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Ensuring browser process is terminated...\n2025-06-08 04:09:18 \u001b[31merror\u001b[39m: [Session: swagger-validation-session-2] Initialization failed due to unrecoverable browser error after 3 attempts.\n2025-06-08 04:09:18 \u001b[31merror\u001b[39m: [Session: swagger-validation-session-2] Handling fatal initialization failure.\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Session removed from active map due to initialization failure.\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Deleting session data folder...\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Attempting to delete session folder: sessions/session-swagger-validation-session-2\n  console.error\n    Failed to send webhook (swagger-validation-session-2, status):\n\n      82 |     (error?: Error): void => {\n      83 |       const errorMsg = error ? error.message : 'Circuit is open';\n    > 84 |       console.error(`Failed to send webhook (${sessionId}, ${dataType}): ${errorMsg}`);\n         |               ^\n      85 |     }\n      86 |   ).catch(() => {\n      87 |     // Ignore errors from webhook calls\n\n      at error (src/utils.ts:84:15)\n      at CircuitBreaker.fallback [as exec] (src/utils.ts:43:14)\n\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-swagger-validation-session-2\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-swagger-validation-session-2\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [Session: swagger-validation-session-2] Session terminated and data cleaned successfully.\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [ReqID: 4nw0qa1k75s] GET /session/terminate/swagger-validation-session-2 [FINISHED] 200 163ms\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [ReqID: 30ndhgo4jy] GET /health [STARTED]\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [ReqID: 30ndhgo4jy] Invalid API key attempt\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [ReqID: 30ndhgo4jy] GET /health [FINISHED] 403 2ms\n  console.log\n    ✓ API key required for: GET /health\n\n      at Object.log (tests/swagger-validation.test.js:310:17)\n\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [ReqID: s7ds0elkdlj] GET /session/all [STARTED]\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [ReqID: s7ds0elkdlj] Invalid API key attempt\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [ReqID: s7ds0elkdlj] GET /session/all [FINISHED] 403 2ms\n  console.log\n    ✓ API key required for: GET /session/all\n\n      at Object.log (tests/swagger-validation.test.js:310:17)\n\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [ReqID: nj73v9hqca] GET /session/start/test-session [STARTED]\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [ReqID: nj73v9hqca] Invalid API key attempt\n2025-06-08 04:09:18 \u001b[33mwarn\u001b[39m: [ReqID: nj73v9hqca] GET /session/start/test-session [FINISHED] 403 1ms\n  console.log\n    ✓ API key required for: GET /session/start/test-session\n\n      at Object.log (tests/swagger-validation.test.js:310:17)\n\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [ReqID: 9asbsx5o06q] GET /health [STARTED]\n2025-06-08 04:09:18 \u001b[32minfo\u001b[39m: [ReqID: 9asbsx5o06q] GET /health [FINISHED] 200 1ms\n  console.log\n    ✓ Valid API key allows access\n\n      at Object.log (tests/swagger-validation.test.js:318:15)\n\n"
    },
    "multiSession": {
      "success": false,
      "total": 0,
      "passed": 0,
      "failed": 0,
      "skipped": 0,
      "duration": 0,
      "error": "Command failed: npm run test:multi-session\nFAIL tests/multi-session.test.js (19.356 s)\n  Multi-Session WhatsApp API Tests\n    Session Creation and Management\n      ✓ should create multiple sessions concurrently (60 ms)\n      ✓ should verify each session has independent status (6291 ms)\n      ✓ should list all active sessions (6 ms)\n      ✓ should handle session restart independently (2026 ms)\n    Session Isolation Tests\n      ✕ should validate session ID format (21 ms)\n      ✓ should handle non-existent session gracefully (4 ms)\n      ✓ should prevent unauthorized access without API key (6 ms)\n    Client Operations with Multiple Sessions\n      ✓ should get client state for each session independently (13 ms)\n      ✓ should validate request body for client operations (26 ms)\n    Error Handling and Edge Cases\n      ✓ should handle concurrent operations on same session (20 ms)\n      ✓ should handle session termination gracefully (2144 ms)\n    Performance and Resource Management\n      ✕ should handle rapid session creation and termination (6325 ms)\n\n  ● Multi-Session WhatsApp API Tests › Session Isolation Tests › should validate session ID format\n\n    expect(received).toHaveProperty(path, value)\n\n    Expected path: \"success\"\n    Received path: []\n\n    Expected value: false\n    Received value: {}\n\n      138 |         const response = await makeRequest('get', `/session/start/${invalidId}`)\n      139 |         expect([400, 404, 422]).toContain(response.status) // Accept any of these as valid error responses\n    > 140 |         expect(response.body).toHaveProperty('success', false)\n          |                               ^\n      141 |\n      142 |         console.log(`Invalid session ID \"${invalidId}\": ${response.status} - ${response.body.error}`)\n      143 |       }\n\n      at Object.toHaveProperty (tests/multi-session.test.js:140:31)\n\n  ● Multi-Session WhatsApp API Tests › Performance and Resource Management › should handle rapid session creation and termination\n\n    ProtocolError: Protocol error (Network.getResponseBody): Target closed.\n\n      at node_modules/whatsapp-web.js/node_modules/puppeteer-core/src/common/Connection.ts:400:16\n      at CDPSessionImpl.send (node_modules/whatsapp-web.js/node_modules/puppeteer-core/src/common/Connection.ts:396:12)\n      at node_modules/whatsapp-web.js/node_modules/puppeteer-core/src/common/HTTPResponse.ts:203:47\n      at HTTPResponse.text (node_modules/whatsapp-web.js/node_modules/puppeteer-core/src/common/HTTPResponse.ts:231:21)\n      at node_modules/whatsapp-web.js/src/Client.js:771:39\n\n  ● Multi-Session WhatsApp API Tests › Performance and Resource Management › should handle rapid session creation and termination\n\n    ProtocolError: Protocol error (Network.getResponseBody): Target closed.\n\n      at node_modules/whatsapp-web.js/node_modules/puppeteer-core/src/common/Connection.ts:400:16\n      at CDPSessionImpl.send (node_modules/whatsapp-web.js/node_modules/puppeteer-core/src/common/Connection.ts:396:12)\n      at node_modules/whatsapp-web.js/node_modules/puppeteer-core/src/common/HTTPResponse.ts:203:47\n      at HTTPResponse.text (node_modules/whatsapp-web.js/node_modules/puppeteer-core/src/common/HTTPResponse.ts:231:21)\n      at node_modules/whatsapp-web.js/src/Client.js:771:39\n\nTest Suites: 1 failed, 1 total\nTests:       2 failed, 10 passed, 12 total\nSnapshots:   0 total\nTime:        19.371 s, estimated 21 s\nRan all test suites matching /tests\\/multi-session.test.js/i.\n",
      "output": "\n> whatsapp-web-api@1.0.0 test:multi-session\n> cross-env PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true DISABLE_WEB_SECURITY=true jest tests/multi-session.test.js --detectOpenHandles --forceExit --timeout=60000\n\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: Attempting to restore sessions from disk...\n  console.log\n    Cleaning up existing test sessions...\n\n      at Object.log (tests/multi-session.test.js:21:13)\n\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: Reading session directory: ./sessions\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: Found items in session directory: 1\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [ReqID: 1lf4yoo5ide] GET /session/terminate/test-session-1 [STARTED]\n  console.log\n    [Controller] Termination requested for session: test-session-1\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-1] Deletion requested\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-1] Session not found in memory. Attempting folder deletion.\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-1] Attempting to delete session folder: sessions/session-test-session-1\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: invalid session] Existing session directory found, initiating restore\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: invalid session] Initiating session setup\n2025-06-08 04:09:20 \u001b[31merror\u001b[39m: [Session: invalid session] Failed to create Client instance: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: Session restore process initiated for 1 sessions.\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-1] Session folder \"sessions/session-test-session-1\" does not exist. Skipping deletion.\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [ReqID: 1lf4yoo5ide] GET /session/terminate/test-session-1 [FINISHED] 200 9ms\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [ReqID: 71fldz448sf] GET /session/terminate/test-session-2 [STARTED]\n  console.log\n    [Controller] Termination requested for session: test-session-2\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-2] Deletion requested\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-2] Session not found in memory. Attempting folder deletion.\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-2] Attempting to delete session folder: sessions/session-test-session-2\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-2] Session folder \"sessions/session-test-session-2\" does not exist. Skipping deletion.\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [ReqID: 71fldz448sf] GET /session/terminate/test-session-2 [FINISHED] 200 4ms\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [ReqID: tus9fg1x1te] GET /session/terminate/test-session-3 [STARTED]\n  console.log\n    [Controller] Termination requested for session: test-session-3\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-3] Deletion requested\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session not found in memory. Attempting folder deletion.\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-3] Attempting to delete session folder: sessions/session-test-session-3\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session folder \"sessions/session-test-session-3\" does not exist. Skipping deletion.\n2025-06-08 04:09:20 \u001b[32minfo\u001b[39m: [ReqID: tus9fg1x1te] GET /session/terminate/test-session-3 [FINISHED] 200 4ms\n  console.log\n    Testing concurrent session creation...\n\n      at Object.log (tests/multi-session.test.js:47:15)\n\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [ReqID: 5tzewfrnujb] GET /session/start/test-session-1 [STARTED]\n  console.log\n    [Controller] Starting new session setup for: test-session-1\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-1] Initiating session setup\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-1] Created session directory: sessions/session-test-session-1\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-1] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-1] Initializing event listeners\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-1] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [ReqID: 5tzewfrnujb] GET /session/start/test-session-1 [FINISHED] 202 17ms\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [ReqID: wbf10ppe3u] GET /session/start/test-session-2 [STARTED]\n  console.log\n    [Controller] Starting new session setup for: test-session-2\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-2] Initiating session setup\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-2] Created session directory: sessions/session-test-session-2\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-2] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-2] Initializing event listeners\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-2] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [ReqID: wbf10ppe3u] GET /session/start/test-session-2 [FINISHED] 202 8ms\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [ReqID: im8eyfrq09] GET /session/start/test-session-3 [STARTED]\n  console.log\n    [Controller] Starting new session setup for: test-session-3\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-3] Initiating session setup\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-3] Created session directory: sessions/session-test-session-3\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-3] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-3] Initializing event listeners\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:22 \u001b[32minfo\u001b[39m: [ReqID: im8eyfrq09] GET /session/start/test-session-3 [FINISHED] 202 6ms\n  console.log\n    Session test-session-1: 202 - Session initialization accepted. Please poll status.\n\n      at log (tests/multi-session.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    Session test-session-2: 202 - Session initialization accepted. Please poll status.\n\n      at log (tests/multi-session.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    Session test-session-3: 202 - Session initialization accepted. Please poll status.\n\n      at log (tests/multi-session.test.js:60:17)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    Testing session independence...\n\n      at Object.log (tests/multi-session.test.js:65:15)\n\n2025-06-08 04:09:25 \u001b[32minfo\u001b[39m: [ReqID: 15ek7d36e5t] GET /session/status/test-session-1 [STARTED]\n2025-06-08 04:09:28 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: 15ek7d36e5t] GET /session/status/test-session-1 [FINISHED] 200 3252ms\n  console.log\n    Session test-session-1 status: INITIALIZING - session_not_connected\n\n      at Object.log (tests/multi-session.test.js:78:17)\n\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: 2bf197q30nn] GET /session/status/test-session-2 [STARTED]\n2025-06-08 04:09:28 \u001b[33mwarn\u001b[39m: [Session: test-session-2] Validation check: Session state is null\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: 2bf197q30nn] GET /session/status/test-session-2 [FINISHED] 200 3ms\n  console.log\n    Session test-session-2 status: INITIALIZING - session_not_connected\n\n      at Object.log (tests/multi-session.test.js:78:17)\n\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: l2u7xeixma] GET /session/status/test-session-3 [STARTED]\n2025-06-08 04:09:28 \u001b[33mwarn\u001b[39m: [Session: test-session-3] Validation check: Session state is null\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: l2u7xeixma] GET /session/status/test-session-3 [FINISHED] 200 5ms\n  console.log\n    Session test-session-3 status: INITIALIZING - session_not_connected\n\n      at Object.log (tests/multi-session.test.js:78:17)\n\n  console.log\n    Testing session listing...\n\n      at Object.log (tests/multi-session.test.js:83:15)\n\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: ouy6exciy2] GET /session/all [STARTED]\n  console.log\n    [Controller] Getting status for all 3 active sessions...\n\n      at log (src/controllers/sessionController.ts:424:13)\n\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: ouy6exciy2] GET /session/all [FINISHED] 200 2ms\n  console.log\n    Found 3 active sessions\n\n      at Object.log (tests/multi-session.test.js:98:15)\n\n  console.log\n    Testing independent session restart...\n\n      at Object.log (tests/multi-session.test.js:102:15)\n\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: 3eq0ruwwhz7] GET /session/restart/test-session-1 [STARTED]\n  console.log\n    [Controller] Restart requested for session: test-session-1\n\n      at log (src/controllers/sessionController.ts:312:13)\n\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [Session: test-session-1] Reload requested\n2025-06-08 04:09:28 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Reload cancelled: Client state is (Destroyed: false, Initializing: true)\n2025-06-08 04:09:28 \u001b[32minfo\u001b[39m: [ReqID: 3eq0ruwwhz7] GET /session/restart/test-session-1 [FINISHED] 200 2ms\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: mbnfjorxtvg] GET /session/status/test-session-2 [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-2] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: mbnfjorxtvg] GET /session/status/test-session-2 [FINISHED] 200 2ms\n  console.log\n    Session test-session-2 after restart of test-session-1: INITIALIZING\n\n      at Object.log (tests/multi-session.test.js:120:17)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: b6tmkp115xr] GET /session/status/test-session-3 [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-3] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: b6tmkp115xr] GET /session/status/test-session-3 [FINISHED] 200 11ms\n  console.log\n    Session test-session-3 after restart of test-session-1: INITIALIZING\n\n      at Object.log (tests/multi-session.test.js:120:17)\n\n  console.log\n    Testing session ID validation...\n\n      at Object.log (tests/multi-session.test.js:127:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: jgdtn4ttrzq] GET /session/start/invalid%20session [STARTED]\n  console.log\n    [Controller] Starting new session setup for: invalid session\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: invalid session] Initiating session setup\n2025-06-08 04:09:30 \u001b[31merror\u001b[39m: [Session: invalid session] Failed to create Client instance: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: jgdtn4ttrzq] GET /session/start/invalid%20session [FINISHED] 422 2ms\n  console.log\n    Invalid session ID \"invalid session\": 422 - Critical setup error: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n\n      at Object.log (tests/multi-session.test.js:142:17)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: 0zjpwvqhup3] GET /session/start/invalid@session [STARTED]\n  console.log\n    [Controller] Starting new session setup for: invalid@session\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: invalid@session] Initiating session setup\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: invalid@session] Created session directory: sessions/session-invalid@session\n2025-06-08 04:09:30 \u001b[31merror\u001b[39m: [Session: invalid@session] Failed to create Client instance: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: 0zjpwvqhup3] GET /session/start/invalid@session [FINISHED] 422 3ms\n  console.log\n    Invalid session ID \"invalid@session\": 422 - Critical setup error: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n\n      at Object.log (tests/multi-session.test.js:142:17)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: 8vm14igmvc6] GET /session/start/invalid.session [STARTED]\n  console.log\n    [Controller] Starting new session setup for: invalid.session\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: invalid.session] Initiating session setup\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: invalid.session] Created session directory: sessions/session-invalid.session\n2025-06-08 04:09:30 \u001b[31merror\u001b[39m: [Session: invalid.session] Failed to create Client instance: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: 8vm14igmvc6] GET /session/start/invalid.session [FINISHED] 422 2ms\n  console.log\n    Invalid session ID \"invalid.session\": 422 - Critical setup error: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n\n      at Object.log (tests/multi-session.test.js:142:17)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: 2re2psr1klm] GET /session/start/ [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: 2re2psr1klm] GET /session/start/ [FINISHED] 404 2ms\n  console.log\n    Testing non-existent session handling...\n\n      at Object.log (tests/multi-session.test.js:147:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: j31ilp5wx88] GET /session/status/non-existent-session-12345 [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: j31ilp5wx88] GET /session/status/non-existent-session-12345 [FINISHED] 404 1ms\n  console.log\n    Non-existent session status: Session not found.\n\n      at Object.log (tests/multi-session.test.js:157:15)\n\n  console.log\n    Testing API key requirement...\n\n      at Object.log (tests/multi-session.test.js:161:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: dh1fcsntvap] GET /session/status/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: dh1fcsntvap] Invalid API key attempt\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: dh1fcsntvap] GET /session/status/test-session-1 [FINISHED] 403 2ms\n  console.log\n    Unauthorized access properly blocked\n\n      at Object.log (tests/multi-session.test.js:168:15)\n\n  console.log\n    Testing independent client state retrieval...\n\n      at Object.log (tests/multi-session.test.js:174:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: ak9k5ri4nf] GET /client/getState/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: ak9k5ri4nf] GET /client/getState/test-session-1 [FINISHED] 200 2ms\n  console.log\n    Client state for test-session-1: null\n\n      at Object.log (tests/multi-session.test.js:185:19)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: 5ubhvlhpsl3] GET /client/getState/test-session-2 [STARTED]\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: 5ubhvlhpsl3] GET /client/getState/test-session-2 [FINISHED] 200 1ms\n  console.log\n    Client state for test-session-2: null\n\n      at Object.log (tests/multi-session.test.js:185:19)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: xui6u5z3m] GET /client/getState/test-session-3 [STARTED]\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: xui6u5z3m] GET /client/getState/test-session-3 [FINISHED] 200 2ms\n  console.log\n    Client state for test-session-3: null\n\n      at Object.log (tests/multi-session.test.js:185:19)\n\n  console.log\n    Testing client operation validation...\n\n      at Object.log (tests/multi-session.test.js:193:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: 216tcn1ct0i] POST /client/getNumberId/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: 216tcn1ct0i] POST /client/getNumberId/test-session-1 [FINISHED] 404 6ms\n  console.log\n    Invalid body validation: 404 - session_not_connected\n\n      at Object.log (tests/multi-session.test.js:210:17)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: opdmoyw5uvm] POST /client/getNumberId/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: opdmoyw5uvm] POST /client/getNumberId/test-session-1 [FINISHED] 404 2ms\n  console.log\n    Invalid body validation: 404 - session_not_connected\n\n      at Object.log (tests/multi-session.test.js:210:17)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: n21lwgg2m89] POST /client/getNumberId/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: n21lwgg2m89] POST /client/getNumberId/test-session-1 [FINISHED] 404 3ms\n  console.log\n    Invalid body validation: 404 - session_not_connected\n\n      at Object.log (tests/multi-session.test.js:210:17)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: j9x0tmajhs] POST /client/getNumberId/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: j9x0tmajhs] POST /client/getNumberId/test-session-1 [FINISHED] 404 3ms\n  console.log\n    Invalid body validation: 404 - session_not_connected\n\n      at Object.log (tests/multi-session.test.js:210:17)\n\n  console.log\n    Testing concurrent operations on same session...\n\n      at Object.log (tests/multi-session.test.js:217:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: xudpb8iv2r9] GET /session/status/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: qbfv1wkjuvg] GET /client/getState/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: ryz98o1kk1h] GET /session/qr/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: ryz98o1kk1h] GET /session/qr/test-session-1 [FINISHED] 202 2ms\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: mvoodn8qj7] GET /client/getWWebVersion/test-session-1 [STARTED]\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: qbfv1wkjuvg] GET /client/getState/test-session-1 [FINISHED] 200 6ms\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: xudpb8iv2r9] GET /session/status/test-session-1 [FINISHED] 200 10ms\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [ReqID: mvoodn8qj7] GET /client/getWWebVersion/test-session-1 [FINISHED] 404 7ms\n  console.log\n    Concurrent operation 0: 200\n\n      at log (tests/multi-session.test.js:235:19)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    Concurrent operation 1: 200\n\n      at log (tests/multi-session.test.js:235:19)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    Concurrent operation 2: 202\n\n      at log (tests/multi-session.test.js:235:19)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    Concurrent operation 3: 404\n\n      at log (tests/multi-session.test.js:235:19)\n          at Array.forEach (<anonymous>)\n\n  console.log\n    Testing graceful session termination...\n\n      at Object.log (tests/multi-session.test.js:243:15)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: a4tuprsln6p] GET /session/terminate/test-session-3 [STARTED]\n  console.log\n    [Controller] Termination requested for session: test-session-3\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Deletion requested\n2025-06-08 04:09:30 \u001b[33mwarn\u001b[39m: [Session: test-session-3] Validation check: Session state is null\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session removed from active map for deletion.\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session in uncertain state (session_not_connected). Attempting destroy...\n2025-06-08 04:09:30 \u001b[31merror\u001b[39m: [Session: test-session-3] Initialization attempt 1/3 failed: Protocol error (Runtime.callFunctionOn): Target closed.\n2025-06-08 04:09:30 \u001b[31merror\u001b[39m: [Session: test-session-3] Potentially unrecoverable browser error detected. Cleaning up browser.\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Attempting graceful browser close\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Killed Chrome processes using profile: /usr/src/app/.wwebjs_auth/session-test-session-3/puppeteer_chrome_profile\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Browser closed gracefully\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Client destroy successful.\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Ensuring browser process is terminated...\n2025-06-08 04:09:30 \u001b[31merror\u001b[39m: [Session: test-session-3] Initialization failed due to unrecoverable browser error after 3 attempts.\n2025-06-08 04:09:30 \u001b[31merror\u001b[39m: [Session: test-session-3] Handling fatal initialization failure.\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session removed from active map due to initialization failure.\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Deleting session data folder...\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Attempting to delete session folder: sessions/session-test-session-3\n  console.error\n    Failed to send webhook (test-session-3, status):\n\n      82 |     (error?: Error): void => {\n      83 |       const errorMsg = error ? error.message : 'Circuit is open';\n    > 84 |       console.error(`Failed to send webhook (${sessionId}, ${dataType}): ${errorMsg}`);\n         |               ^\n      85 |     }\n      86 |   ).catch(() => {\n      87 |     // Ignore errors from webhook calls\n\n      at error (src/utils.ts:84:15)\n      at CircuitBreaker.fallback [as exec] (src/utils.ts:43:14)\n\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-test-session-3\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-test-session-3\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session terminated and data cleaned successfully.\n2025-06-08 04:09:30 \u001b[32minfo\u001b[39m: [ReqID: a4tuprsln6p] GET /session/terminate/test-session-3 [FINISHED] 200 112ms\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: luz2nn9w8ja] GET /session/status/test-session-1 [STARTED]\n2025-06-08 04:09:32 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: luz2nn9w8ja] GET /session/status/test-session-1 [FINISHED] 200 7ms\n  console.log\n    Session test-session-1 after terminating test-session-3: INITIALIZING\n\n      at Object.log (tests/multi-session.test.js:260:17)\n\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: ojt4o4zxk8r] GET /session/status/test-session-2 [STARTED]\n2025-06-08 04:09:32 \u001b[33mwarn\u001b[39m: [Session: test-session-2] Validation check: Session state is null\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: ojt4o4zxk8r] GET /session/status/test-session-2 [FINISHED] 200 5ms\n  console.log\n    Session test-session-2 after terminating test-session-3: INITIALIZING\n\n      at Object.log (tests/multi-session.test.js:260:17)\n\n  console.log\n    Testing rapid session lifecycle...\n\n      at Object.log (tests/multi-session.test.js:267:15)\n\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: idrwa0ui74b] GET /session/start/rapid-1 [STARTED]\n  console.log\n    [Controller] Starting new session setup for: rapid-1\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-1] Initiating session setup\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-1] Created session directory: sessions/session-rapid-1\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-1] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-1] Initializing event listeners\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-1] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: idrwa0ui74b] GET /session/start/rapid-1 [FINISHED] 202 6ms\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: pbji58dpcpg] GET /session/start/rapid-2 [STARTED]\n  console.log\n    [Controller] Starting new session setup for: rapid-2\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-2] Initiating session setup\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-2] Created session directory: sessions/session-rapid-2\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-2] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-2] Initializing event listeners\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-2] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: pbji58dpcpg] GET /session/start/rapid-2 [FINISHED] 202 5ms\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: u8jabimk1ji] GET /session/start/rapid-3 [STARTED]\n  console.log\n    [Controller] Starting new session setup for: rapid-3\n\n      at log (src/controllers/sessionController.ts:47:15)\n\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-3] Initiating session setup\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-3] Created session directory: sessions/session-rapid-3\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-3] Initializing session (Attempt 1/3)...\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-3] Initializing event listeners\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [Session: rapid-3] Session added to active sessions map. Initialization running in background.\n2025-06-08 04:09:32 \u001b[32minfo\u001b[39m: [ReqID: u8jabimk1ji] GET /session/start/rapid-3 [FINISHED] 202 4ms\n2025-06-08 04:09:33 \u001b[32minfo\u001b[39m: [ReqID: f28t0qsadyt] GET /session/terminate/rapid-1 [STARTED]\n  console.log\n    [Controller] Termination requested for session: rapid-1\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:33 \u001b[32minfo\u001b[39m: [Session: rapid-1] Deletion requested\n2025-06-08 04:09:33 \u001b[32minfo\u001b[39m: [ReqID: z7irtrtzg3] GET /session/terminate/rapid-2 [STARTED]\n  console.log\n    [Controller] Termination requested for session: rapid-2\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:33 \u001b[32minfo\u001b[39m: [Session: rapid-2] Deletion requested\n2025-06-08 04:09:33 \u001b[32minfo\u001b[39m: [ReqID: jndo7ussqor] GET /session/terminate/rapid-3 [STARTED]\n  console.log\n    [Controller] Termination requested for session: rapid-3\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:33 \u001b[32minfo\u001b[39m: [Session: rapid-3] Deletion requested\n2025-06-08 04:09:38 \u001b[33mwarn\u001b[39m: [Session: rapid-1] Validation check: Page evaluation failed: page_evaluation_timeout\n2025-06-08 04:09:38 \u001b[33mwarn\u001b[39m: [Session: rapid-2] Validation check: Page evaluation failed: page_evaluation_timeout\n2025-06-08 04:09:38 \u001b[33mwarn\u001b[39m: [Session: rapid-3] Validation check: Page evaluation failed: page_evaluation_timeout\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Session removed from active map for deletion.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Session in uncertain state (page_unresponsive). Attempting destroy...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-1] Initialization attempt 1/3 failed: Navigation failed because browser has disconnected!\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-1] Potentially unrecoverable browser error detected. Cleaning up browser.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Attempting graceful browser close\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Session removed from active map for deletion.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Session in uncertain state (page_unresponsive). Attempting destroy...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-2] Initialization attempt 1/3 failed: Navigation failed because browser has disconnected!\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-2] Potentially unrecoverable browser error detected. Cleaning up browser.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Attempting graceful browser close\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Session removed from active map for deletion.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Session in uncertain state (page_unresponsive). Attempting destroy...\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Browser closed gracefully\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Client destroy successful.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Ensuring browser process is terminated...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-1] Initialization failed due to unrecoverable browser error after 3 attempts.\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-1] Handling fatal initialization failure.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Session removed from active map due to initialization failure.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Deleting session data folder...\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Attempting to delete session folder: sessions/session-rapid-1\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-3] Initialization attempt 1/3 failed: Navigation failed because browser has disconnected!\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-3] Potentially unrecoverable browser error detected. Cleaning up browser.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Attempting graceful browser close\n  console.error\n    Failed to send webhook (rapid-1, status):\n\n      82 |     (error?: Error): void => {\n      83 |       const errorMsg = error ? error.message : 'Circuit is open';\n    > 84 |       console.error(`Failed to send webhook (${sessionId}, ${dataType}): ${errorMsg}`);\n         |               ^\n      85 |     }\n      86 |   ).catch(() => {\n      87 |     // Ignore errors from webhook calls\n\n      at error (src/utils.ts:84:15)\n      at CircuitBreaker.fallback [as exec] (src/utils.ts:43:14)\n\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-rapid-1\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-rapid-1\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-1] Session terminated and data cleaned successfully.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: f28t0qsadyt] GET /session/terminate/rapid-1 [FINISHED] 200 5270ms\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Browser closed gracefully\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Client destroy successful.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Ensuring browser process is terminated...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-2] Initialization failed due to unrecoverable browser error after 3 attempts.\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-2] Handling fatal initialization failure.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Session removed from active map due to initialization failure.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Deleting session data folder...\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Attempting to delete session folder: sessions/session-rapid-2\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Browser closed gracefully\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Client destroy successful.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Ensuring browser process is terminated...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-3] Initialization failed due to unrecoverable browser error after 3 attempts.\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: rapid-3] Handling fatal initialization failure.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Session removed from active map due to initialization failure.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Deleting session data folder...\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Attempting to delete session folder: sessions/session-rapid-3\n  console.error\n    Failed to send webhook (rapid-2, status):\n\n      82 |     (error?: Error): void => {\n      83 |       const errorMsg = error ? error.message : 'Circuit is open';\n    > 84 |       console.error(`Failed to send webhook (${sessionId}, ${dataType}): ${errorMsg}`);\n         |               ^\n      85 |     }\n      86 |   ).catch(() => {\n      87 |     // Ignore errors from webhook calls\n\n      at error (src/utils.ts:84:15)\n      at CircuitBreaker.fallback [as exec] (src/utils.ts:43:14)\n\n  console.error\n    Failed to send webhook (rapid-3, status):\n\n      82 |     (error?: Error): void => {\n      83 |       const errorMsg = error ? error.message : 'Circuit is open';\n    > 84 |       console.error(`Failed to send webhook (${sessionId}, ${dataType}): ${errorMsg}`);\n         |               ^\n      85 |     }\n      86 |   ).catch(() => {\n      87 |     // Ignore errors from webhook calls\n\n      at error (src/utils.ts:84:15)\n      at CircuitBreaker.fallback [as exec] (src/utils.ts:43:14)\n\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-rapid-2\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-rapid-3\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-rapid-2\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-2] Session terminated and data cleaned successfully.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: z7irtrtzg3] GET /session/terminate/rapid-2 [FINISHED] 200 5281ms\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-rapid-3\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: rapid-3] Session terminated and data cleaned successfully.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: jndo7ussqor] GET /session/terminate/rapid-3 [FINISHED] 200 5280ms\n  console.log\n    Rapid lifecycle test completed successfully\n\n      at Object.log (tests/multi-session.test.js:293:17)\n\n  console.log\n    Final cleanup of test sessions...\n\n      at Object.log (tests/multi-session.test.js:35:13)\n\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: egz5zrpfqs] GET /session/terminate/test-session-1 [STARTED]\n  console.log\n    [Controller] Termination requested for session: test-session-1\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Deletion requested\n2025-06-08 04:09:39 \u001b[33mwarn\u001b[39m: [Session: test-session-1] Validation check: Session state is null\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Session removed from active map for deletion.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Session in uncertain state (session_not_connected). Attempting destroy...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: test-session-1] Initialization attempt 1/3 failed: Protocol error (Runtime.callFunctionOn): Target closed.\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: test-session-1] Potentially unrecoverable browser error detected. Cleaning up browser.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Attempting graceful browser close\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Browser closed gracefully\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Client destroy successful.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Ensuring browser process is terminated...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: test-session-1] Initialization failed due to unrecoverable browser error after 3 attempts.\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: test-session-1] Handling fatal initialization failure.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Session removed from active map due to initialization failure.\n  console.error\n    Failed to send webhook (test-session-1, status): Circuit is open\n\n      82 |     (error?: Error): void => {\n      83 |       const errorMsg = error ? error.message : 'Circuit is open';\n    > 84 |       console.error(`Failed to send webhook (${sessionId}, ${dataType}): ${errorMsg}`);\n         |               ^\n      85 |     }\n      86 |   ).catch(() => {\n      87 |     // Ignore errors from webhook calls\n\n      at error (src/utils.ts:84:15)\n      at CircuitBreaker.fallback [as exec] (src/utils.ts:33:16)\n      at exec (src/utils.ts:71:25)\n      at handleInitializationFailure (src/sessions.ts:299:17)\n      at handleInitializationFailure (src/sessions.ts:266:15)\n\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Deleting session data folder...\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Attempting to delete session folder: sessions/session-test-session-1\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-test-session-1\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-test-session-1\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-1] Session terminated and data cleaned successfully.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: egz5zrpfqs] GET /session/terminate/test-session-1 [FINISHED] 200 32ms\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: k8y4tx3kw] GET /session/terminate/test-session-2 [STARTED]\n  console.log\n    [Controller] Termination requested for session: test-session-2\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Deletion requested\n2025-06-08 04:09:39 \u001b[33mwarn\u001b[39m: [Session: test-session-2] Validation check: Session state is null\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Session removed from active map for deletion.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Session in uncertain state (session_not_connected). Attempting destroy...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: test-session-2] Initialization attempt 1/3 failed: Protocol error (Runtime.callFunctionOn): Target closed.\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: test-session-2] Potentially unrecoverable browser error detected. Cleaning up browser.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Attempting graceful browser close\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Browser closed gracefully\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Client destroy successful.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Ensuring browser process is terminated...\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: test-session-2] Initialization failed due to unrecoverable browser error after 3 attempts.\n2025-06-08 04:09:39 \u001b[31merror\u001b[39m: [Session: test-session-2] Handling fatal initialization failure.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Session removed from active map due to initialization failure.\n  console.error\n    Failed to send webhook (test-session-2, status): Circuit is open\n\n      82 |     (error?: Error): void => {\n      83 |       const errorMsg = error ? error.message : 'Circuit is open';\n    > 84 |       console.error(`Failed to send webhook (${sessionId}, ${dataType}): ${errorMsg}`);\n         |               ^\n      85 |     }\n      86 |   ).catch(() => {\n      87 |     // Ignore errors from webhook calls\n\n      at error (src/utils.ts:84:15)\n      at CircuitBreaker.fallback [as exec] (src/utils.ts:33:16)\n      at exec (src/utils.ts:71:25)\n      at handleInitializationFailure (src/sessions.ts:299:17)\n      at handleInitializationFailure (src/sessions.ts:266:15)\n\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Deleting session data folder...\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Attempting to delete session folder: sessions/session-test-session-2\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Deleting directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-test-session-2\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Successfully deleted directory: /Users/sheldon/Documents/GitHub/whatsapp-api/sessions/session-test-session-2\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-2] Session terminated and data cleaned successfully.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: k8y4tx3kw] GET /session/terminate/test-session-2 [FINISHED] 200 38ms\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: 2y78fo73seb] GET /session/terminate/test-session-3 [STARTED]\n  console.log\n    [Controller] Termination requested for session: test-session-3\n\n      at log (src/controllers/sessionController.ts:345:13)\n\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-3] Deletion requested\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session not found in memory. Attempting folder deletion.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-3] Attempting to delete session folder: sessions/session-test-session-3\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [Session: test-session-3] Session folder \"sessions/session-test-session-3\" does not exist. Skipping deletion.\n2025-06-08 04:09:39 \u001b[32minfo\u001b[39m: [ReqID: 2y78fo73seb] GET /session/terminate/test-session-3 [FINISHED] 200 3ms\n"
    },
    "api": {
      "success": true,
      "total": 0,
      "passed": 0,
      "failed": 0,
      "skipped": 0,
      "duration": 0,
      "output": "\n> whatsapp-web-api@1.0.0 test:api\n> cross-env PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true DISABLE_WEB_SECURITY=true jest tests/api.test.js --detectOpenHandles --forceExit\n\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: Attempting to restore sessions from disk...\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: Reading session directory: ./sessions\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: Found items in session directory: 1\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: [ReqID: f4nsqjjweew] GET /ping [STARTED]\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: [ReqID: f4nsqjjweew] GET /ping [FINISHED] 200 3ms\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: [Session: invalid session] Existing session directory found, initiating restore\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: [Session: invalid session] Initiating session setup\n2025-06-08 04:09:19 \u001b[31merror\u001b[39m: [Session: invalid session] Failed to create Client instance: Invalid clientId. Only alphanumeric characters, underscores and hyphens are allowed.\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: Session restore process initiated for 1 sessions.\n2025-06-08 04:09:19 \u001b[32minfo\u001b[39m: [ReqID: gfm69ne65k] GET /health [STARTED]\n2025-06-08 04:09:19 \u001b[33mwarn\u001b[39m: [ReqID: gfm69ne65k] Invalid API key attempt\n2025-06-08 04:09:19 \u001b[33mwarn\u001b[39m: [ReqID: gfm69ne65k] GET /health [FINISHED] 403 2ms\n"
    },
    "summary": {
      "totalTests": 0,
      "passedTests": 0,
      "failedTests": 0,
      "skippedTests": 0,
      "duration": 34765
    },
    "issues": [
      "Multi-session functionality tests failed",
      "Low test success rate: 0.0%"
    ],
    "recommendations": [
      "Review session management and isolation mechanisms",
      "Address failing tests to improve API reliability",
      "✓ Swagger documentation is properly validated",
      "✓ Basic API functionality is working correctly"
    ]
  },
  "environment": {
    "nodeVersion": "v23.11.0",
    "platform": "darwin",
    "arch": "arm64"
  }
}